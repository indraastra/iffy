title: "Transition Test"
author: "Test"
blurb: "Testing flag-based story endings"
version: "1.0"
context: "A simple test for understanding flag-based endings"

narrative:
  voice: "Clear and direct"
  tone: "Testing focused"

# Simple flags to test transition logic
flags:
  door_opened:
    default: false
    description: "when the player opens the door"
  
  ready_to_leave:
    default: false
    description: "when the player is ready to leave the room"
  
  walked_through:
    default: false
    description: "when the player walks through the door"

scenes:
  room:
    sketch: |
      You're in a simple room. There's a **door** to the east.
      
      You can:
      - "open door" (sets door_opened flag)
      - "get ready to leave" (sets ready_to_leave flag)
      - "walk through door" (ends the test if both flags are set)
      
    guidance: |
      Simple test scene. Set flags based on player actions:
      - "door_opened" when they open the door
      - "ready_to_leave" when they get ready
      - "walked_through" when they walk through the door (only if both other flags are set)

# Simple ending for completeness
endings:
  requires:
    all_of: ["walked_through"]
  variations:
    - id: "test_complete"
      requires:
        all_of: ["door_opened", "ready_to_leave", "walked_through"]
      sketch: |
        You walk through the open door, ready to leave. The test is complete!
        
        This demonstrates that all three conditions were met:
        1. The door was opened
        2. You were ready to leave
        3. You explicitly walked through

guidance: |
  Test story to understand flag-based endings:
  
  1. Try "open door" - sets door_opened flag
  2. Try "get ready to leave" - sets ready_to_leave flag
  3. Try "walk through door" - sets walked_through flag (only if both other flags are set)
  
  The ending triggers when all three flags are set. The LLM should only set
  walked_through when the player explicitly tries to walk through AND both
  prerequisites are met.