title: "The Last Signal"
author: "Example Author"
version: "1.0"

metadata:
  setting:
    time: "Near future, 2045"
    place: "Abandoned radio telescope facility, Chilean Andes"
  tone:
    overall: "Tense scientific thriller with cosmic horror undertones"
    narrative_voice: "Second person, present tense, sparse and technical"
  themes:
    - "Isolation and discovery"
    - "The price of knowledge"
    - "Human insignificance in the cosmos"
  ui:
    colors:
      primary: "#1a1a2e"
      background: "#0f0f23"
      text: "#eee"

characters:
  - id: "sarah"
    name: "Dr. Sarah Chen"
    traits:
      - "brilliant"
      - "obsessive"
      - "sleep-deprived"
    voice: "Clipped scientific precision, occasionally slips into wonder"
    description: |
      Your colleague and former mentor. She's been alone at the facility for three 
      months, decoding what she claims is an extraterrestrial signal. Her emails 
      grew increasingly frantic before stopping entirely a week ago.
    relationships:
      marcus: "Professional acquaintance"
      player: "Former student, worried colleague"

  - id: "marcus"
    name: "Marcus Webb"
    traits:
      - "skeptical"
      - "protective"
      - "pragmatic"
    voice: "Military background shows. Short sentences. Always planning exits."
    description: |
      The security contractor hired to escort you to the facility. He doesn't 
      believe in aliens, but he's seen enough to know when someone's in trouble.

locations:
  - id: "entrance"
    name: "Facility Entrance"
    connections:
      - "control_room"
      - "dormitory"
      - "observation_deck"
    description: |
      The access road ends at a chain-link gate topped with razor wire. The facility 
      sprawls beyond: a collection of prefab buildings huddled around the massive 
      radio dish. The dish points at an empty patch of sky, unmoving. Emergency 
      lights blink in the gathering dusk.
    objects:
      - name: "Security badge"
        description: "Clipped to the guardhouse window"
        id: "security_badge"
      - name: "Flashlight"
        description: "Heavy-duty, in the security kit"
        id: "flashlight"
      - name: "Gate controls"
        description: "Require power to operate"

  - id: "control_room"
    name: "Control Room"
    connections:
      - "entrance"
      - "server_room"
    description: |
      Banks of monitors glow in the darkness. Most show static, but one displays 
      a repeating pattern of symbols. Coffee cups and energy drink cans litter 
      every surface. Sarah's notebook lies open on the main console.
    objects:
      - name: "Sarah's notebook"
        description: "Filled with increasingly erratic calculations"
        id: "notebook"
      - name: "Main console"
        description: "Still receiving the signal"
      - name: "Emergency radio"
        description: "For contacting the outside world"

  - id: "dormitory"
    name: "Dormitory"
    connections:
      - "entrance"
      - "sarahs_room"
    description: |
      Four rooms branch off a common area. Three doors hang open, revealing 
      stripped bunks. The fourth - Sarah's - is locked from the inside.
    objects:
      - name: "Fire axe"
        description: "In the emergency cabinet"
        id: "fire_axe"
      - name: "Master keycard"
        description: "In the facility manager's room"
        id: "master_keycard"

  - id: "sarahs_room"
    name: "Sarah's Room"
    connections:
      - "dormitory"
    description: |
      The walls are covered in printouts, star charts, and mathematical proofs. 
      Red string connects different points, forming a pattern that hurts to look 
      at. Sarah sits at her desk, headphones on, swaying slightly.

  - id: "server_room"
    name: "Server Room"
    connections:
      - "control_room"
    description: |
      Temperature-controlled and humming with electricity. The servers store 
      petabytes of radio telescope data. One rack blinks with unusual activity - 
      it's processing the signal in real-time.
    objects:
      - name: "Server logs"
        description: "Show the signal's true origin"
      - name: "Power controls"
        description: "Could shut down the entire facility"

  - id: "observation_deck"
    name: "Observation Deck"
    connections:
      - "entrance"
    description: |
      An external platform with a clear view of the dish and the sky above. The 
      stars seem wrong somehow - too bright, too close, arranged in patterns 
      that match Sarah's drawings.

items:
  - id: "security_badge"
    name: "Security Badge"
    description: "Grants access to restricted areas. Sarah's photo stares back at you."
    location: "entrance"

  - id: "notebook"
    name: "Sarah's Notebook"
    description: |
      Filled with calculations that transition from orderly to frantic. The last 
      entry just repeats 'They're coming.'
    location: "control_room"

  - id: "fire_axe"
    name: "Fire Axe"
    description: "Standard emergency equipment. Could break down doors."
    location: "dormitory"

  - id: "master_keycard"
    name: "Master Keycard"
    description: "Opens any door in the facility."
    location: "dormitory"

  - id: "signal_data"
    name: "Signal Recording"
    description: "A USB drive containing the complete signal. Sarah's life work."
    location: "none"

knowledge:
  - id: "signal_exists"
    description: "There's a mysterious signal being received at the facility"
    requires: []

  - id: "signal_is_countdown"
    description: "The signal is actually a countdown to something"
    requires:
      - "has_item:notebook"

  - id: "signal_origin"
    description: "The signal comes from within our solar system, not deep space"
    requires:
      - "location:server_room"

  - id: "sarah_isolated"
    description: "Sarah has been alone here for three months"
    requires:
      - "location:sarahs_room"

flows:
  - id: "first_steps"
    type: "narrative"
    name: "Initial Exploration"
    requirements: []
    sets:
      - "facility_entered"
    content: |
      You push through the gate, Marcus close behind. The facility is eerily quiet 
      except for the hum of electronics and the occasional groan of metal in the wind.
      
      "Place gives me the creeps," Marcus mutters, hand resting on his sidearm. 
      "Your friend better be worth this."
    next:
      - type: "narrative"
        trigger: "examine control room"
        flow_id: "control_room_discovery"
      - type: "narrative"
        trigger: "check dormitory"
        flow_id: "dormitory_search"
      - type: "narrative"
        trigger: "go to observation deck"
        flow_id: "observation_deck_visit"
    player_goal: "Explore the facility and gather information"
    hint: "Check the control room for clues about Sarah's work"

  - id: "control_room_discovery"
    type: "narrative"
    name: "The Control Room"
    requirements:
      - "facility_entered"
    content: |
      The control room hums with electronic life. Multiple monitors display the same 
      repeating pattern - a complex mathematical sequence that seems almost hypnotic. 
      Coffee cups and energy drink cans litter every surface, evidence of Sarah's 
      sleepless vigil.
    next:
      - type: "narrative"
        trigger: "examine notebook"
        flow_id: "find_notebook"
      - type: "narrative"
        trigger: "study the signal"
        flow_id: "signal_analysis"

  - id: "find_notebook"
    type: "narrative"
    name: "The Discovery"
    requirements:
      - "has_item:notebook"
    sets:
      - "knows:signal_is_countdown"
    content: |
      Sarah's notebook tells a terrifying story. The signal isn't random - it's a 
      countdown. Mathematical proofs fill page after page, all reaching the same 
      conclusion: something is coming. The final pages deteriorate into frantic 
      sketches of star configurations and repeated phrases: "They're already here" 
      and "The sky is wrong."
      
      Marcus reads over your shoulder, his skepticism cracking. "This... this can't 
      be real."
      
      But deep down, you know it is. You've felt it since you arrived - a presence, 
      vast and patient, waiting just beyond perception.
    next:
      - type: "narrative"
        trigger: "find Sarah"
        flow_id: "find_sarah"
      - type: "narrative"
        trigger: "check server room"
        flow_id: "server_room_visit"
    player_goal: "Find Sarah and understand what she's discovered"

  - id: "find_sarah"
    type: "narrative"
    name: "Confrontation"
    requirements:
      - "location:sarahs_room"
    sets:
      - "found_sarah"
    content: |
      Sarah doesn't respond when you enter. She sits perfectly still, headphones 
      pressed to her ears, eyes closed. The monitors around her show the signal in 
      various forms - waveforms, mathematical translations, visual representations 
      that seem to move when you're not looking directly at them.
      
      You touch her shoulder. Her eyes snap open, pupils dilated to black circles.
      
      "You're late," she whispers. "They've been waiting."
    next:
      - type: "dialogue"
        trigger: "talk to Sarah"
        flow_id: "sarah_revelation"
    player_goal: "Talk to Sarah and uncover the truth"

  - id: "sarah_revelation"
    type: "dialogue"
    name: "Sarah's Revelation"
    participants:
      - "sarah"
      - "player"
    location: "sarahs_room"
    requirements:
      - "found_sarah"
    exchanges:
      - speaker: "sarah"
        text: |
          "Forty-seven days. That's how long I've been listening. At first, I 
          thought it was a pulsar, maybe a new type. But the pattern... it's too 
          deliberate. Too perfect."
      - speaker: "player"
        choices:
          - text: "Sarah, you need help. Let us get you out of here."
            next: "sarah_resists"
          - text: "Show me everything. Help me understand."
            next: "server_revelation"
            sets: ["sarah_explains"]
          - text: "What happens in forty-seven days?"
            next: "countdown_explanation"
      - speaker: "sarah"
        text: |
          "You can feel it too, can't you? The weight of their attention. They've 
          been broadcasting for millennia, waiting for someone to listen. And now... 
          now they know we're here."

  - id: "server_revelation"
    type: "narrative"
    name: "The Truth"
    requirements:
      - "sarah_explains"
    sets:
      - "knows:signal_origin"
      - "knows_truth"
    content: |
      Sarah leads you to the server room, where the logs reveal everything. The signal 
      isn't from deep space - it's from something much closer. Something that's been 
      in our solar system for thousands of years, hidden in the outer dark. Sarah's 
      calculations are correct: it's moving now, accelerating toward Earth.
      
      But there's more. The signal isn't just a countdown. It's an invitation. Or 
      a warning. The mathematics suggest two possible interpretations:
      
      1. Join us and transcend your limitations
      2. Prepare for harvesting
      
      Marcus stands beside you, face pale. "We need to warn everyone. Call the 
      authorities, the military-"
      
      "No." Sarah shakes her head. "Don't you understand? Responding was the test. 
      Humanity failed the moment I decoded their message."
    next:
      - type: "narrative"
        trigger: "consider options"
        flow_id: "final_decision"
    player_goal: "Decide what to do with this knowledge"

  - id: "final_decision"
    type: "narrative"
    name: "The Choice"
    requirements:
      - "knows_truth"
    sets:
      - "choice_made"
    content: |
      You stand in the control room, the weight of humanity's future in your hands. 
      The signal pulses on the screen, hypnotic and terrible. Sarah offers you a 
      USB drive - all her research, all the data.
      
      "You can destroy it," she says. "Shut down the facility, bury the truth. 
      Maybe they'll pass us by. Or..." She gestures to the transmission equipment. 
      "We can answer. Accept whatever comes next."
      
      Marcus raises his weapon. "There's a third option. We fight. Prepare defenses, 
      rally the world-"
      
      "Against beings that can broadcast across galaxies?" Sarah laughs, but there's 
      no humor in it. "They're not coming to fight, Marcus. They're coming to collect."
      
      The choice is yours. The signal awaits your response.
    next:
      - type: "narrative"
        trigger: "destroy the signal"
        flow_id: "ending_silence"
        sets: ["destroyed_signal"]
      - type: "narrative"
        trigger: "answer the signal"
        flow_id: "ending_transcendence"
        sets: ["answered_signal"]
      - type: "narrative"
        trigger: "warn the world"
        flow_id: "ending_resistance"
        sets: ["warned_world"]
    player_goal: "Choose humanity's fate"

  - id: "ending_silence"
    type: "narrative"
    name: "Silence"
    requirements:
      - "choice_made"
    content: |
      You pull the power controls, plunging the facility into darkness. One by one, 
      the servers spin down. The signal fades to nothing. In the sudden quiet, you 
      can hear your own heartbeat, Marcus's relieved breathing, Sarah's quiet sobbing.
      
      "Maybe they'll forget," you whisper. "Maybe we're too small to matter."
      
      But as you leave the facility, you can't shake the feeling that something vast 
      and patient has turned its attention elsewhere. For now.

  - id: "ending_transcendence"
    type: "narrative"
    name: "Transcendence"
    requirements:
      - "choice_made"
    content: |
      Your fingers move across the keyboard, inputting the response sequence Sarah 
      discovered. The transmission array aligns, and a new signal pierces the night 
      sky - humanity's answer to the cosmos.
      
      For a moment, nothing. Then the screens explode with data - coordinates, 
      schematics, knowledge beyond human comprehension. Sarah laughs, tears streaming 
      down her face. "They're coming! They're finally coming!"
      
      Marcus lowers his weapon, understanding the futility. Above, the stars begin to 
      move, rearranging themselves into the patterns from Sarah's drawings.
      
      Change is coming. Evolution or extinction - in forty-seven days, you'll know which.

  - id: "ending_resistance"
    type: "narrative"
    name: "Resistance"
    requirements:
      - "choice_made"
    content: |
      You broadcast everything - the signal, Sarah's research, video testimony. Within 
      hours, the facility swarms with military personnel, scientists, world leaders. 
      Humanity mobilizes as never before.
      
      Sarah watches from custody, a sad smile on her face. "You've given us forty-seven 
      days of hope," she says. "That's something, I suppose."
      
      The world prepares for war against an enemy it cannot comprehend. You've done 
      what you could. Whether it's enough... only time will tell.
      
      But in quiet moments, you still hear it - the signal, somehow, broadcasting from 
      everywhere and nowhere. Counting down.

start:
  text: |
    The helicopter touches down just as the sun sets behind the Andes. Marcus helps 
    you out, his hand steady on your elbow. "Two hours," he says. "Then we leave, 
    with or without her."
    
    The facility looks abandoned, but you know Sarah's in there somewhere. Her last 
    message plays in your mind: "I've found something incredible. Come alone. Trust 
    no one else."
    
    The wind picks up, carrying the scent of ozone and something else - something 
    that makes your teeth ache.
  location: "entrance"
  first_flow: "first_steps"
  sets:
    - "game_started"

endings:
  - id: "silence"
    name: "Silence"
    requires:
      - "destroyed_signal"
    content: |
      You pull the power controls, plunging the facility into darkness. One by one, 
      the servers spin down. The signal fades to nothing. In the sudden quiet, you 
      can hear your own heartbeat, Marcus's relieved breathing, Sarah's quiet sobbing.
      
      "Maybe they'll forget," you whisper. "Maybe we're too small to matter."
      
      But as you leave the facility, you can't shake the feeling that something vast 
      and patient has turned its attention elsewhere. For now.

  - id: "transcendence"
    name: "Transcendence"
    requires:
      - "answered_signal"
    content: |
      Your fingers move across the keyboard, inputting the response sequence Sarah 
      discovered. The transmission array aligns, and a new signal pierces the night 
      sky - humanity's answer to the cosmos.
      
      For a moment, nothing. Then the screens explode with data - coordinates, 
      schematics, knowledge beyond human comprehension. Sarah laughs, tears streaming 
      down her face. "They're coming! They're finally coming!"
      
      Marcus lowers his weapon, understanding the futility. Above, the stars begin to 
      move, rearranging themselves into the patterns from Sarah's drawings.
      
      Change is coming. Evolution or extinction - in forty-seven days, you'll know which.

  - id: "resistance"
    name: "Resistance"
    requires:
      - "warned_world"
    content: |
      You broadcast everything - the signal, Sarah's research, video testimony. Within 
      hours, the facility swarms with military personnel, scientists, world leaders. 
      Humanity mobilizes as never before.
      
      Sarah watches from custody, a sad smile on her face. "You've given us forty-seven 
      days of hope," she says. "That's something, I suppose."
      
      The world prepares for war against an enemy it cannot comprehend. You've done 
      what you could. Whether it's enough... only time will tell.
      
      But in quiet moments, you still hear it - the signal, somehow, broadcasting from 
      everywhere and nowhere. Counting down.