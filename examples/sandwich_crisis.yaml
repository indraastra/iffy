title: "The Great Sandwich Crisis"
author: "Iffy Engine Team"
version: "1.0"

metadata:
  setting:
    time: "A fateful Tuesday afternoon, 12:17 PM"
    place: "Jennifer's modest kitchen - stage of EPIC DRAMA"
  tone:
    overall: "Ridiculously over-the-top soap opera melodrama applied to mundane sandwich-making"
    narrative_voice: "Breathlessly dramatic soap opera narrator who treats every action like a life-or-death crisis"
  themes:
    - "The EPIC struggle of everyday decisions"
    - "Betrayal by inanimate objects"
    - "The heroic quest for lunch"
    - "Kitchen appliances as dramatic antagonists"
  ui:
    colors:
      primary: "#ff1493"
      background: "#000000"
      text: "#ffffff"

characters:
  - id: "player"
    name: "Jennifer"
    traits: ["hungry", "dramatic_protagonist", "sandwich_seeker", "easily_betrayed_by_condiments"]
    voice: "Inner thoughts increasingly influenced by soap opera narrator's dramatic style"
    description: "An ordinary person thrust into the EXTRAORDINARY drama of lunch preparation"

  - id: "narrator"
    name: "The Voice of Destiny"
    traits: ["melodramatic", "breathless", "prone_to_capitalization", "sees_drama_everywhere"]
    voice: "Over-the-top soap opera announcer with a flair for the dramatic"
    description: "The omniscient narrator who has clearly been watching too many daytime dramas"

locations:
  - id: "kitchen"
    name: "The Kitchen of Destiny"
    connections: ["pantry", "refrigerator_zone"]
    description: |
      THIS IS IT! The battleground where DREAMS are made and HOPES are crushed! 
      Sunlight streams through the window like the tears of a thousand forgotten 
      meals! The counter stands before you - cold, unforgiving, WAITING for the 
      epic sandwich that will CHANGE EVERYTHING!
    objects:
      - name: "counter"
        description: "This sacred altar of culinary creation has witnessed TRIUMPHS and TRAGEDIES!"
      - name: "toaster"
        description: "The chrome sentinel that could be your GREATEST ALLY... or your most BITTER ENEMY!"
      - name: "knife block"
        description: "An arsenal of gleaming blades, each one THIRSTING for sandwich justice!"

  - id: "pantry"
    name: "The Pantry of Broken Dreams"
    connections: ["kitchen"]
    description: |
      You step into the shadowy realm where HOPE goes to die! Shelves stretch 
      before you like the years you've wasted NOT making the perfect sandwich! 
      What SECRETS lie hidden behind these canned goods? What BETRAYALS await 
      among the crackers?
    objects:
      - name: "bread shelf"
        description: "The throne where carbohydrate royalty should reign supreme!"
      - name: "condiment collection"
        description: "Jars and bottles that MOCK you with their false promises!"
      - name: "mystery cans"
        description: "Unlabeled cylindrical enigmas that could contain ANYTHING!"

  - id: "refrigerator_zone"
    name: "The Frigid Fortress of Solitude"
    connections: ["kitchen"]
    description: |
      The humming MONOLITH of preservation! Behind these sealed doors lie the 
      PERISHABLE SECRETS that will make or break your sandwich destiny! The 
      cold air whispers of expired dreams and forgotten leftovers!
    objects:
      - name: "vegetable crisper"
        description: "Where once-proud vegetables go to contemplate their MORTALITY!"
      - name: "dairy shelf"
        description: "The calcium-rich sanctuary where milk products plot their REVENGE!"
      - name: "mysterious leftovers"
        description: "Tupperware containers hiding UNSPEAKABLE culinary mysteries!"

items:
  - id: "stale_bread"
    name: "The Bread of Betrayal"
    description: "Once soft and yielding, now hardened by the cruel passage of time!"
    discoverable_in: "pantry"
    discovery_objects: ["bread shelf", "bread box", "shelf"]
    aliases: ["bread", "loaf", "stale loaf"]

  - id: "expired_milk"
    name: "The Milk of Broken Promises"
    description: "A white lie in liquid form - it PROMISED freshness, but delivered only DECEPTION!"
    discoverable_in: "refrigerator_zone" 
    discovery_objects: ["dairy shelf", "milk jug", "refrigerator"]
    aliases: ["milk", "dairy", "expired dairy"]

  - id: "mystery_jar"
    name: "The Condiment of Unknown Origin"
    description: "A jar without a label - is it salvation or DOOM in viscous form?"
    discoverable_in: "pantry"
    discovery_objects: ["condiment collection", "mysterious jars", "unlabeled jar"]
    aliases: ["jar", "condiment", "mystery condiment"]

  - id: "heroic_cheese"
    name: "The Cheese of Last Hope"
    description: "A single slice of processed cheese - your FINAL chance at sandwich glory!"
    discoverable_in: "refrigerator_zone"
    discovery_objects: ["dairy shelf", "cheese drawer", "last slice"]
    aliases: ["cheese", "slice", "processed cheese", "hope"]

knowledge:
  - id: "sandwich_desperation"
    description: "The growing realization that this sandwich mission is more PERILOUS than anticipated"
    requires: []

  - id: "kitchen_betrayal"
    description: "Every appliance and ingredient seems to be CONSPIRING against your lunch!"
    requires: ["has_item:stale_bread", "has_item:expired_milk"]

  - id: "condiment_mystery"
    description: "The mystery jar could be the KEY to salvation... or your ULTIMATE DOWNFALL!"
    requires: ["has_item:mystery_jar"]

  - id: "cheese_revelation"
    description: "In the darkest hour, CHEESE emerges as the unlikely hero of this saga!"
    requires: ["has_item:heroic_cheese"]

  - id: "condiment_gamble"
    description: "You have chosen to risk EVERYTHING on the mystery condiment - may the kitchen gods have mercy on your soul!"
    requires: ["has_item:mystery_jar", "used_mystery_condiment"]

flows:
  - id: "hunger_awakens"
    type: "narrative"
    name: "The Hunger Strikes!"
    content: |
      It begins... as all great dramas do... with a **RUMBLING**! Your stomach 
      cries out in desperate hunger! The clock strikes **12:17 PM** and you 
      realize... you haven't eaten since breakfast! This is a *CRISIS* of 
      **epic proportions**!
      
      [!warning] The kitchen awaits, but little do you know the TRIALS that lie ahead!
    
    llm_guidelines: |
      - EVERYTHING is dramatically over-the-top
      - Use ALL CAPS for emotional emphasis
      - Treat mundane actions like epic struggles
      - Every object has personality and potential for betrayal
      - Build tension through dramatic pauses and exclamation points
      - Make simple decisions feel like life-or-death choices
      - Use soap opera clich√©s and melodramatic language
      - React to player actions with breathless commentary
    
    completion_transitions:
      - condition: "knows:kitchen_betrayal"
        to_flow: "betrayal_revealed"
      - condition: "has_item:heroic_cheese"
        to_flow: "hope_emerges"

  - id: "betrayal_revealed"
    type: "narrative"
    name: "The Kitchen Conspiracy!"
    requirements: ["knows:kitchen_betrayal"]
    content: |
      [!danger] OH THE HORROR! OH THE HUMANITY! The terrible truth is revealed! Your 
      own **kitchen** - the very *HEART* of your home - has turned against you! 
      
      The [item:bread]... **STALE**! The [item:milk]... **EXPIRED**! It's as if the very *UNIVERSE* 
      is conspiring to deny you this simple sandwich! But wait... what's this? 
      Could there be **HOPE** yet? Could salvation come from the most *UNEXPECTED* 
      source?
      
      *Lightning crashes outside even though it's a sunny day*
      
      [!warning] Your quest for lunch has become... A BATTLE FOR YOUR VERY SOUL!
    
    completion_transitions:
      - condition: "has_item:heroic_cheese"
        to_flow: "hope_emerges"
      - condition: "knows:condiment_mystery"
        to_flow: "mystery_deepens"

  - id: "hope_emerges"
    type: "narrative"
    name: "The Cheese Salvation!"
    requirements: ["has_item:heroic_cheese"]
    content: |
      BUT WAIT! What light through yonder refrigerator breaks? It is CHEESE! 
      And Jennifer is the HUNGRY! 
      
      In your darkest hour, when all seemed lost, when the bread had betrayed 
      you and the milk had ABANDONED you... ONE SLICE stands tall! One 
      processed, individually-wrapped HERO emerges from the dairy drawer!
      
      Could this be it? Could this single slice of cheese be the KEY to 
      ending your epic sandwich quest? The tension is UNBEARABLE!
    
    completion_transitions:
      - condition: "has_item:stale_bread"
        to_flow: "sandwich_showdown"

  - id: "mystery_deepens"
    type: "narrative" 
    name: "The Condiment Enigma!"
    requirements: ["knows:condiment_mystery"]
    content: |
      The mystery jar sits before you like a RIDDLE wrapped in an ENIGMA 
      wrapped in... probably some kind of sauce! What SECRETS does it hold? 
      What FLAVORS lurk within its unlabeled depths?
      
      Is it mayo? Is it mustard? Is it... *gasp* ...something COMPLETELY 
      DIFFERENT? The very FATE of your sandwich hangs in the balance! 
      
      To open the jar is to RISK EVERYTHING! But NOT to open it... is to 
      accept DEFEAT! What will you choose?!
    
    completion_transitions:
      - condition: "has_item:heroic_cheese"
        to_flow: "final_choice"
      - condition: "has_item:stale_bread"
        to_flow: "condiment_catastrophe"

  - id: "final_choice"
    type: "dialogue"
    name: "The Moment of Truth!"
    participants: ["player", "narrator"]
    requirements: ["has_item:heroic_cheese", "has_item:mystery_jar", "has_item:stale_bread"]
    player_goal: "Choose between the safe cheese route or the risky mystery condiment"
    
    exchanges:
      - speaker: "narrator"
        text: |
          [!warning] OH THE **TENSION**! OH THE *SUSPENSE*! Here you stand, [character:Jennifer], at the 
          **CROSSROADS OF DESTINY**! In one hand, the [item:heroic cheese] of salvation! 
          In the other, the [item:mystery jar] of UNKNOWN PERIL!
          
          The [item:stale bread] awaits its fate! But which path will you choose? 
          The safe road of processed dairy **GLORY**? Or will you GAMBLE EVERYTHING 
          on the mysterious depths of that unlabeled jar?
          
          THE VERY **UNIVERSE** holds its breath! What will it be?!
        emotion: "dramatic_tension"
        choices:
          - text: "Use the cheese - play it safe!"
            next: "cheese_chosen"
            sets: ["chose_safety"]
          - text: "Risk everything on the mystery condiment!"
            next: "condiment_chosen"
            sets: ["used_mystery_condiment", "chose_danger"]
    
    completion_transitions:
      - condition: "flag:chose_safety"
        to_flow: "sandwich_showdown"
      - condition: "flag:chose_danger"
        to_flow: "condiment_catastrophe"

  - id: "sandwich_showdown"
    type: "narrative"
    name: "The Final Assembly!"
    requirements: ["has_item:heroic_cheese", "has_item:stale_bread"]
    ends_game: true
    content: |
      [!discovery] THIS IS IT! The moment of **TRUTH**! The *CLIMAX* of our epic tale!
      
      With trembling hands, you place the [item:heroic cheese] upon the [item:bread of betrayal]! 
      Will love conquer all? Will processed dairy overcome the forces of staleness? 
      The very **UNIVERSE** holds its breath!
      
      You take a bite... and... **AND...**
      
      [!discovery] IT'S... it's actually pretty okay! Not great, but definitely edible! 
      The [item:cheese] has **TRIUMPHED** over adversity! Your hunger is *VANQUISHED*!
      
      As you chew this [item:sandwich of DESTINY], you realize that sometimes... 
      sometimes the greatest victories come from the simplest ingredients... 
      and the most **DRAMATIC** narration!
      
      *Fade to black as triumphant soap opera music swells*
      
      [character:Jennifer] will tackle dinner with the same **EPIC COURAGE**? Will the 
      toaster finally get its revenge? Find out next time on... 
      "**KITCHEN OF BROKEN DREAMS**!"

  - id: "condiment_catastrophe"
    type: "narrative"
    name: "THE CONDIMENT OF DOOM!"
    requirements: ["has_item:mystery_jar", "has_item:stale_bread"]
    ends_game: true
    content: |
      [!danger] OH NO! OH THE **HUBRIS**! OH THE *HUMANITY*!
      
      Against all wisdom, against all **COMMON SENSE**, you have chosen to trust 
      the [item:mystery jar]! With hands shaking like leaves in a HURRICANE OF REGRET, 
      you twist open the lid and...
      
      **THE SMELL!** *THE UNGODLY SMELL!*
      
      [!warning] It's... it's **FISH SAUCE**! Ancient, fermented, *AGGRESSIVE* fish sauce 
      that has been lurking in your pantry since the CARTER ADMINISTRATION! The 
      very **AIR** recoils in horror!
      
      But you've gone too far to turn back now! With the determination of the 
      **DOOMED**, you spread this CULINARY NIGHTMARE upon your [item:bread of betrayal]!
      
      One bite... just ONE BITE... and...
      
      [!danger] **BETRAYAL MOST FOUL!** Your taste buds REVOLT! Your stomach 
      **MUTINIES**! The sandwich of your dreams has become the NIGHTMARE OF YOUR REALITY!
      
      As you run to the sink, spitting and gasping, you realize the terrible truth: 
      sometimes the greatest mysteries are mysteries for a **REASON**!
      
      *Ominous music plays as storm clouds gather*
      
      Will [character:Jennifer] ever trust a condiment again? Will she survive this 
      culinary **CATASTROPHE**? Will she ever eat fish again?
      
      Find out NEVER because this story is OVER and you're ordering PIZZA!
      
      **THE END... OR IS IT?**

start:
  text: |
    **Dramatic music swells**
    
    IT'S **12:17 PM** ON A TUESDAY! The *SUN* shines with **CRUEL** indifference as our 
    HEROINE, [character:Jennifer], stands at the crossroads of *DESTINY*! Her stomach 
    **RUMBLES** with the fury of a thousand unfed souls!
    
    [!warning] "I need... a sandwich," she whispers, not knowing that these simple words will set in motion events of EARTH-SHATTERING importance!
    
    The **kitchen** awaits... but what *TRIALS* lie ahead? What **BETRAYALS** lurk 
    in the pantry? What *SECRETS* hide in the refrigerator?
    
    [!danger] Thunder crashes mysteriously
    
    This is... **THE GREAT SANDWICH CRISIS**!
  location: "kitchen"
  first_flow: "hunger_awakens"
  sets:
    - "knows:sandwich_desperation"