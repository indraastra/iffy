title: "The Lost Keys"
author: "Iffy Engine Team"
version: "1.0"

metadata:
  setting:
    time: "Present day"
    place: "Your apartment before an important meeting"
  tone:
    overall: "Light domestic stress with building urgency"
    narrative_voice: "Second person, present tense, relatable and slightly frantic"
  themes:
    - "Everyday problems"
    - "Time pressure"
    - "Problem solving"
  ui:
    colors:
      primary: "#4a5568"
      background: "#f7fafc"
      text: "#2d3748"

characters:
  - id: "player"
    name: "You"
    traits:
      - "stressed"
      - "running_late"
      - "methodical_when_calm"
    voice: "Internal thoughts, increasingly frantic"
    description: "You have an important job interview in 30 minutes and can't find your keys."

locations:
  - id: "living_room"
    name: "Living Room"
    connections:
      - "kitchen"
      - "bedroom"
      - "bathroom"
    description: |
      Your cozy living room, usually tidy but now showing signs of your frantic search.
      Couch cushions askew, magazines scattered. The coffee table holds yesterday's
      newspaper and an empty mug.
    objects:
      - name: "Couch"
        description: "A well-worn sofa with deep cushions - things fall into the cracks"
      - name: "Coffee table" 
        description: "Glass top with magazines, newspaper, and miscellaneous items"
      - name: "TV stand"
        description: "Entertainment center with various electronics and cables"

  - id: "kitchen"
    name: "Kitchen"
    connections:
      - "living_room"
    description: |
      Your small but functional kitchen. Dishes from last night's dinner are still
      in the sink. The counter has the usual appliances and a fruit bowl.

  - id: "bedroom"
    name: "Bedroom"
    connections:
      - "living_room"
    description: |
      Your bedroom in its typical morning chaos - clothes on the floor, unmade bed,
      dresser top cluttered with personal items.

  - id: "bathroom"
    name: "Bathroom"
    connections:
      - "living_room"
    description: |
      Small bathroom with the usual fixtures. The counter around the sink has
      toiletries and personal care items.

items:
  - id: "car_keys"
    name: "Car Keys"
    description: "Your keychain with car key, house key, and a small flashlight attached"
    discoverable_in: "bedroom"
    discovery_objects: ["dresser", "dresser top", "dresser surface"]
    aliases: ["keychain", "keys", "car key", "house key"]

  - id: "backup_phone"
    name: "Old Phone"
    description: "Your old smartphone, could be useful for calling a rideshare"
    discoverable_in: "bedroom"
    discovery_objects: ["dresser drawer", "drawer", "old electronics"]
    aliases: ["phone", "smartphone", "old phone"]

knowledge:
  - id: "interview_location"
    description: "You remember the exact address of your interview"
    requires: []

  - id: "rideshare_option"
    description: "You could call a rideshare if you can't find the keys"
    requires:
      - "has_item:backup_phone"

flows:
  - id: "apartment_search"
    type: "open_scene"
    name: "The Frantic Search"
    description: |
      You're standing in your living room, 30 minutes before the most important
      job interview of your career. Your keys are nowhere to be seen. Where did
      you put them last night? Think... you came home, you were tired, you must
      have set them down somewhere without thinking.
      
      The clock is ticking. You need to find those keys or figure out another
      way to get to the interview.
    
    story_elements:
      evidence:
        - id: "find_car_keys"
          type: "item"
          object: "car_keys"
          location_hints: ["where you'd set them down", "common key spots", "automatic habits"]
          discovery_clues:
            - "Think about last night's routine"
            - "Where do tired people drop things?"
            - "Check the obvious places first"
            - "Sometimes they fall behind or under things"
          natural_actions: 
            - "search couch cushions"
            - "check coffee table"
            - "look in kitchen"
            - "examine coat pockets"
            - "search bedroom"
            - "check bathroom counter"
          difficulty: "moderate"
          
        - id: "find_backup_phone"
          type: "item"
          object: "backup_phone"
          location_hints: ["bedroom storage", "old electronics", "backup items"]
          discovery_clues:
            - "You keep old tech around just in case"
            - "Probably in a drawer or on the dresser"
            - "Could call a rideshare as backup plan"
          natural_actions:
            - "search bedroom drawers"
            - "check dresser"
            - "look for old electronics"
            - "find backup options"
          difficulty: "easy"
          
        - id: "remember_routine"
          type: "knowledge"
          fact: "evening_routine"
          location_hints: ["retrace your steps", "think about last night"]
          discovery_clues:
            - "You were carrying groceries"
            - "You were exhausted from work"
            - "What's the first thing you do when you get home?"
          natural_actions:
            - "think about last night"
            - "retrace your steps"
            - "remember coming home"
            - "recall your routine"
          difficulty: "easy"
    
    progression:
      completion_threshold:
        evidence_found: 1  # Just need to find keys OR backup plan
        
      hint_escalation:
        after_turns: 2
        progression: ["subtle", "direct", "explicit"]
        
      synergies:
        - if_found: "remember_routine"
          then_easier: "find_car_keys"
          reason: "Remembering your routine helps you think of where you might have put them"
    
    completion_transitions:
      - condition: "has_item:car_keys"
        to_flow: "success_ending"
      - condition: "rideshare_called"
        to_flow: "rideshare_ending"
        
    llm_guidelines: |
      - Generate realistic searching behavior and discoveries
      - Match the growing urgency and stress of being late
      - Provide satisfying "aha!" moments when items are found
      - Consider logical places someone might absent-mindedly put keys
      - Build tension through time pressure but don't make it impossible
      - Reward both methodical searching and lateral thinking

  - id: "success_ending"
    type: "narrative"
    name: "Found Them!"
    requirements:
      - "has_item:car_keys"
    ends_game: true
    content: |
      There! Your keys glint in the morning light, exactly where any reasonable
      person would have put them... if they'd been thinking clearly last night.
      
      You grab them with relief, check your watch - still 20 minutes to get there.
      Tight, but doable. You rush out the door, already mentally rehearsing your
      interview answers.
      
      Some days start badly but end well.
      
      You made it to the interview on time, keys found and confidence restored.
      Sometimes a little morning chaos is exactly the energy you need to succeed.

  - id: "rideshare_ending"  
    type: "narrative"
    name: "Plan B"
    requirements:
      - "rideshare_called"
    ends_game: true
    content: |
      Keys are still missing, but your old phone will save the day. You quickly
      open the rideshare app - 8 minutes for pickup, 15 minutes to get there.
      You'll arrive exactly on time.
      
      Sometimes the backup plan works better than the original. You'll deal with
      the keys later - right now, you have an interview to ace.
      
      The rideshare got you there perfectly on time. When you tell the interviewer
      about your morning adventure, they're impressed by your problem-solving skills
      under pressure. The keys can wait - you nailed the interview.

start:
  text: |
    Your alarm didn't go off. Or maybe it did and you snoozed it one too many times.
    Either way, you're now running 30 minutes behind schedule for the job interview
    you've been preparing for all week.
    
    Shower: done. Professional outfit: on. Resume: in hand. Car keys: ...nowhere to be found.
    
    This cannot be happening.
  location: "living_room"
  first_flow: "apartment_search"
  sets:
    - "knows:interview_location"

